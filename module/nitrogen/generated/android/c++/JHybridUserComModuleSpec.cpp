///
/// JHybridUserComModuleSpec.cpp
/// This file was generated by nitrogen. DO NOT MODIFY THIS FILE.
/// https://github.com/mrousavy/nitro
/// Copyright Â© 2025 Marc Rousavy @ Margelo
///

#include "JHybridUserComModuleSpec.hpp"

// Forward declaration of `UserComModuleConfig` to properly resolve imports.
namespace margelo::nitro::usercom { struct UserComModuleConfig; }
// Forward declaration of `UserComModuleUserData` to properly resolve imports.
namespace margelo::nitro::usercom { struct UserComModuleUserData; }
// Forward declaration of `UserComProductEventType` to properly resolve imports.
namespace margelo::nitro::usercom { enum class UserComProductEventType; }

#include <NitroModules/Promise.hpp>
#include <NitroModules/JPromise.hpp>
#include <NitroModules/Null.hpp>
#include <string>
#include <variant>
#include "JUserComModuleRegisterUserResponse.hpp"
#include <NitroModules/JNull.hpp>
#include "UserComModuleConfig.hpp"
#include "JUserComModuleConfig.hpp"
#include <optional>
#include "UserComModuleUserData.hpp"
#include "JUserComModuleUserData.hpp"
#include <unordered_map>
#include "JUserComModuleAttributeValue.hpp"
#include "UserComProductEventType.hpp"
#include "JUserComProductEventType.hpp"
#include <NitroModules/AnyMap.hpp>
#include <NitroModules/JAnyMap.hpp>

namespace margelo::nitro::usercom {

  jni::local_ref<JHybridUserComModuleSpec::jhybriddata> JHybridUserComModuleSpec::initHybrid(jni::alias_ref<jhybridobject> jThis) {
    return makeCxxInstance(jThis);
  }

  void JHybridUserComModuleSpec::registerNatives() {
    registerHybrid({
      makeNativeMethod("initHybrid", JHybridUserComModuleSpec::initHybrid),
    });
  }

  size_t JHybridUserComModuleSpec::getExternalMemorySize() noexcept {
    static const auto method = javaClassStatic()->getMethod<jlong()>("getMemorySize");
    return method(_javaPart);
  }

  void JHybridUserComModuleSpec::dispose() noexcept {
    static const auto method = javaClassStatic()->getMethod<void()>("dispose");
    method(_javaPart);
  }

  std::string JHybridUserComModuleSpec::toString() {
    static const auto method = javaClassStatic()->getMethod<jni::JString()>("toString");
    auto javaString = method(_javaPart);
    return javaString->toStdString();
  }

  // Properties
  

  // Methods
  std::shared_ptr<Promise<void>> JHybridUserComModuleSpec::initialize(const UserComModuleConfig& config) {
    static const auto method = javaClassStatic()->getMethod<jni::local_ref<JPromise::javaobject>(jni::alias_ref<JUserComModuleConfig> /* config */)>("initialize");
    auto __result = method(_javaPart, JUserComModuleConfig::fromCpp(config));
    return [&]() {
      auto __promise = Promise<void>::create();
      __result->cthis()->addOnResolvedListener([=](const jni::alias_ref<jni::JObject>& /* unit */) {
        __promise->resolve();
      });
      __result->cthis()->addOnRejectedListener([=](const jni::alias_ref<jni::JThrowable>& __throwable) {
        jni::JniException __jniError(__throwable);
        __promise->reject(std::make_exception_ptr(__jniError));
      });
      return __promise;
    }();
  }
  std::shared_ptr<Promise<std::variant<nitro::NullType, std::string>>> JHybridUserComModuleSpec::registerUser(const UserComModuleUserData& userData) {
    static const auto method = javaClassStatic()->getMethod<jni::local_ref<JPromise::javaobject>(jni::alias_ref<JUserComModuleUserData> /* userData */)>("registerUser");
    auto __result = method(_javaPart, JUserComModuleUserData::fromCpp(userData));
    return [&]() {
      auto __promise = Promise<std::variant<nitro::NullType, std::string>>::create();
      __result->cthis()->addOnResolvedListener([=](const jni::alias_ref<jni::JObject>& __boxedResult) {
        auto __result = jni::static_ref_cast<JUserComModuleRegisterUserResponse>(__boxedResult);
        __promise->resolve(__result->toCpp());
      });
      __result->cthis()->addOnRejectedListener([=](const jni::alias_ref<jni::JThrowable>& __throwable) {
        jni::JniException __jniError(__throwable);
        __promise->reject(std::make_exception_ptr(__jniError));
      });
      return __promise;
    }();
  }
  std::shared_ptr<Promise<void>> JHybridUserComModuleSpec::logout() {
    static const auto method = javaClassStatic()->getMethod<jni::local_ref<JPromise::javaobject>()>("logout");
    auto __result = method(_javaPart);
    return [&]() {
      auto __promise = Promise<void>::create();
      __result->cthis()->addOnResolvedListener([=](const jni::alias_ref<jni::JObject>& /* unit */) {
        __promise->resolve();
      });
      __result->cthis()->addOnRejectedListener([=](const jni::alias_ref<jni::JThrowable>& __throwable) {
        jni::JniException __jniError(__throwable);
        __promise->reject(std::make_exception_ptr(__jniError));
      });
      return __promise;
    }();
  }
  std::shared_ptr<Promise<void>> JHybridUserComModuleSpec::sendProductEvent(const std::string& productId, UserComProductEventType eventType, const std::optional<std::shared_ptr<AnyMap>>& params) {
    static const auto method = javaClassStatic()->getMethod<jni::local_ref<JPromise::javaobject>(jni::alias_ref<jni::JString> /* productId */, jni::alias_ref<JUserComProductEventType> /* eventType */, jni::alias_ref<JAnyMap::javaobject> /* params */)>("sendProductEvent");
    auto __result = method(_javaPart, jni::make_jstring(productId), JUserComProductEventType::fromCpp(eventType), params.has_value() ? JAnyMap::create(params.value()) : nullptr);
    return [&]() {
      auto __promise = Promise<void>::create();
      __result->cthis()->addOnResolvedListener([=](const jni::alias_ref<jni::JObject>& /* unit */) {
        __promise->resolve();
      });
      __result->cthis()->addOnRejectedListener([=](const jni::alias_ref<jni::JThrowable>& __throwable) {
        jni::JniException __jniError(__throwable);
        __promise->reject(std::make_exception_ptr(__jniError));
      });
      return __promise;
    }();
  }
  std::shared_ptr<Promise<void>> JHybridUserComModuleSpec::sendCustomEvent(const std::string& eventName, const std::shared_ptr<AnyMap>& data) {
    static const auto method = javaClassStatic()->getMethod<jni::local_ref<JPromise::javaobject>(jni::alias_ref<jni::JString> /* eventName */, jni::alias_ref<JAnyMap::javaobject> /* data */)>("sendCustomEvent");
    auto __result = method(_javaPart, jni::make_jstring(eventName), JAnyMap::create(data));
    return [&]() {
      auto __promise = Promise<void>::create();
      __result->cthis()->addOnResolvedListener([=](const jni::alias_ref<jni::JObject>& /* unit */) {
        __promise->resolve();
      });
      __result->cthis()->addOnRejectedListener([=](const jni::alias_ref<jni::JThrowable>& __throwable) {
        jni::JniException __jniError(__throwable);
        __promise->reject(std::make_exception_ptr(__jniError));
      });
      return __promise;
    }();
  }

} // namespace margelo::nitro::usercom
